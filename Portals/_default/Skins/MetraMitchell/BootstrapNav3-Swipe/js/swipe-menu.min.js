var swipeMenu=function(){var b,c,d,e,f,j,k,g=.2,h=.1,i=2;if(!jQuery)throw"jQuery is required";b=$(".swipe-menu .navbar-nav"),d=$(".navbar-collapse.swipe-menu"),c=$("button.swipe-menu-toggle");var l=function(){j=d.data("swipeBackClass"),k=d.data("swipeBackText");var a=b.add(b.find("ul.dropdown-menu, ul.navbar-nav"));a.each(function(){var b=$(this).children("li");b.each(function(){var b=$(this).children("a"),c=void 0===k?b.text():k,d=b.attr("href");T(d)?$(this).children("ul").prepend('<li class="back"><a class="swipe-arrow"><span class="swipe-nav-back glyphicon '+j+'"></span></a><a href="'+d+'">'+c+"</a></li>"):$(this).children("ul").prepend('<li class="back"><a href="'+d+'"><span class="swipe-nav-back glyphicon '+j+'"></span>'+c+"</a></li>")})})},m=function(){return R()?(P(b.find("li")),O(b.children("li")),v(b,0,0),b.find("ul").removeClass("visible"),b.addClass("visible","true"),void 0):!0},n=function(){d.hasClass("in")&&(d.removeClass("in"),d.addClass("collapse"),c.addClass("collapsed"))},o=function(a,c){var d=this;d.navbarStartX=b.offset().left,a&&(d.touchStartX=a.pageX,d.touchStartY=a.pageY,d.touchStartRelativeX=d.touchStartX-d.navbarStartX),d.isVertical=null,d.isRight=null,d.isMoving=!1,d.canMove=function(){return d.isRight?$(c).parent(".dropdown-menu").length>0:$(c).children(".dropdown-menu").length>0}},p=function(a){var b=this;b.time=(new Date).getTime(),b.x=a.pageX,b.y=a.pageY},q=function(a){return!0},r=function(a){if(!R())return!0;var b=$(a.target).closest("li");if(q(b)){var c=a.changedTouches[0];f=new o(c,this),e=[new p(c)]}},s=function(a){a.parent().children("li").children(".dropdown-menu").removeClass("visible")},t=function(a){a.children("a").focus(),s(a),a.children("ul").addClass("visible")},u=function(a){if(!R())return!0;var b=$(a.target).closest("li");if(q(b)){var c=a.changedTouches;if(!(c.length>1)){var d=c[0];e.length===i&&e.pop(),e.unshift(new p(d));var g=e.length<i;if(!g&&null===f.isVertical){var h=e[0].x-f.touchStartX,j=e[0].y-f.touchStartY;f.isVertical=Math.abs(j)>Math.abs(h),f.isRight=!f.isVertical&&h>0}g||(f.isVertical||a.preventDefault(),!f.isMoving&&f.canMove()&&(f.isMoving=!0,f.isVertical?s(b):t(b)),f.isVertical||y(this,d))}}},v=function(a,b,c){w(),a.css("webkitTransitionDuration",c+"s"),a.css("MozTransitionDuration",c+"s"),a.css("msTransitionDuration",c+"s"),a.css("OTransitionDuration",c+"s"),a.css("transitionDuration",c+"s"),a.css("webkitTransform","translate("+b+"px,0)"+"translateZ(0)"),a.css("msTransform","translateX("+b+"px)"),a.css("MozTransform","translateX("+b+"px)"),a.css("OTransform","translateX("+b+"px)")},w=function(){b.css("left","")},x=function(){b.css("left",0)},y=function(a,c){if(f.canMove()){var d=c.pageX-f.touchStartRelativeX;v(b,d,0)}},z=function(a){A(a)},A=function(a){if(!R())return!0;var b=e.length;e=null;var c=$(a.target).closest("li");if(!q(c))return!1;if(i>b)return!0;if(a.preventDefault(),a.stopPropagation(),!f.canMove())return s(c),!1;if(!f.isVertical){document.body.getBoundingClientRect().height;var g=c.parent(),j=B(g);h>j?F(c):f.isRight?E(c):D(c)}return!1},B=function(a){var b=a.offset().left,c=a.width();return f.isRight?1-Math.abs((c-b)/c):1-Math.abs((c+b)/c)},C=function(a){return(1-B(a))*g},D=function(a){var c=a.parent();P(c.children("li"));var d=f.navbarStartX-b.width();v(b,d,C(c)),b.one(M(),function(){x(),G(),O(a.children("ul").children("li"))})},E=function(a){var c=a.parent();P(c.children("li"));var d=c.parent(".dropdown, .dropdown-submenu").parent(),e=f.navbarStartX+b.width();v(b,e,C(c)),b.one(M(),function(){c.removeClass("visible"),x(),G(),O(d.children("li"))})},F=function(a){var c=a.parent();P(c.children("li"));var d=f.navbarStartX;v(b,d,C(c)),b.one(M(),function(){s(a),O(c.children("li"))})},G=function(){$(".swipe-menu .navbar-nav")[0].getBoundingClientRect().top<0&&$("html,body").animate({scrollTop:b.offset().top})},H=function(){d.hasClass("in")||m()},I=function(a){return R()?null!=e&&e.length>=i?!0:(a.preventDefault(),J($(a.target).closest("li")),void 0):!0},J=function(a){f=new o(null,a),f.isRight=!1,t(a),D(a)},K=function(a){return R()?null!=e&&e.length>=i?!0:(a.preventDefault(),L($(a.target).closest("li")),void 0):!0},L=function(a){f=new o(null,a),f.isRight=!0,E(a)},M=function(){var a,b=document.createElement("fakeelement"),c={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c)if(void 0!==b.style[a])return c[a]},O=function(a){a.each(function(a,b){b.addEventListener&&(b.addEventListener("touchstart",r,!1),b.addEventListener("touchmove",u,!1),b.addEventListener("touchend",A,!1),b.addEventListener("touchcancel",z,!1))})},P=function(a){a.each(function(a,b){b.addEventListener&&(b.removeEventListener("touchstart",r,!1),b.removeEventListener("touchmove",u,!1),b.removeEventListener("touchend",A,!1),b.removeEventListener("touchcancel",z,!1))})},Q=function(a){a.preventDefault()},R=function(){return d.hasClass("in")},S=function(a){if(!R())return!0;var b=$(a.target),c=b.attr("href");return T(c)?void 0:(a.preventDefault(),b.closest("li").hasClass("back")?K(a):I(a),!1)},T=function(a){return"#"!==a&&""!==a};l(),$(window).on("orientationchange",n),O(b.children("li")),b.find(".swipe-nav-next").on("touchend mouseup",I),b.find(".swipe-nav-back").on("touchend mouseup",K),b.find(".swipe-nav-next").on("click",Q),b.find(".swipe-nav-back").on("click",Q),b.find("a").on("click",S),c.on("click",H),m()};jQuery(window).one("load",function(){window.swipeMenu=new swipeMenu});